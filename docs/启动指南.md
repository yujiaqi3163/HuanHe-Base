# ğŸš€ é¡¹ç›®å®Œæ•´å¯åŠ¨æŒ‡å—

## ğŸ“‹ å‰ç½®æ¡ä»¶

ç¡®ä¿å·²å®‰è£…ï¼š
- Python 3.8+
- Redisï¼ˆæˆ– Memurai for Windowsï¼‰
- é¡¹ç›®ä¾èµ–ï¼ˆ`pip install -r requirements.txt`ï¼‰

---

## ğŸ¯ å¿«é€Ÿå¯åŠ¨ï¼ˆ3 ä¸ªç»ˆç«¯ï¼‰

### ç»ˆç«¯ 1 - å¯åŠ¨ Redis

**Windows ç”¨æˆ·ï¼š**
```cmd
# å¦‚æœä½¿ç”¨ Memurai
memurai.exe

# æˆ–è€…å¦‚æœå®‰è£…äº† Redis
redis-server.exe
```

**æˆ–è€…ä½¿ç”¨ Dockerï¼ˆæ¨èï¼‰ï¼š**
```bash
docker run -d -p 6379:6379 --name my-redis redis:alpine
```

---

### ç»ˆç«¯ 2 - å¯åŠ¨ Celery Worker

**Windows ç”¨æˆ·ï¼ˆåŒå‡»è¿è¡Œï¼‰ï¼š**
```
start_worker.bat
```

**æˆ–è€…æ‰‹åŠ¨è¿è¡Œï¼š**
```bash
celery -A celery_config worker --loglevel=info --pool=solo
```

**Linux/Mac ç”¨æˆ·ï¼š**
```bash
celery -A celery_config worker --loglevel=info
```

---

### ç»ˆç«¯ 3 - å¯åŠ¨ Flask åº”ç”¨

```bash
python run.py
```

---

## âœ… éªŒè¯å¯åŠ¨æˆåŠŸ

### æ£€æŸ¥ Redis
```bash
redis-cli ping
# åº”è¯¥è¿”å›: PONG
```

### æ£€æŸ¥ Celery Worker
åœ¨ Worker ç»ˆç«¯åº”è¯¥çœ‹åˆ°ï¼š
```
[INFO] Connected to redis://localhost:6379/0
[INFO] celery@... ready.
```

### æ£€æŸ¥ Flask
è®¿é—®ï¼šhttp://127.0.0.1:5000

---

## ğŸ› ï¸ å¸¸è§é—®é¢˜

### é—®é¢˜ 1ï¼šRedis æœªå¯åŠ¨
**é”™è¯¯ï¼š** `Error 10061 connecting to localhost:6379`

**è§£å†³ï¼š** å¯åŠ¨ Redis æˆ– Memurai

---

### é—®é¢˜ 2ï¼šä»»åŠ¡ä¸€ç›´"ç­‰å¾…ä¸­"
**åŸå› ï¼š** Celery Worker æœªå¯åŠ¨

**è§£å†³ï¼š** ç¡®ä¿è¿è¡Œäº† `start_worker.bat` æˆ– `celery -A celery_config worker...`

---

### é—®é¢˜ 3ï¼š`No module named 'celery'`
**è§£å†³ï¼š** å®‰è£…ä¾èµ–
```bash
pip install -r requirements.txt
```

---

## ğŸ“ ç¯å¢ƒå˜é‡é…ç½®

ç¡®ä¿ `.env` æ–‡ä»¶åŒ…å«ï¼š
```env
SECRET_KEY=your_strong_secret_key

DEEPSEEK_API_KEY=your_deepseek_key
DEEPSEEK_API_BASE=https://api.deepseek.com

MAIL_USERNAME=your_email@163.com
MAIL_PASSWORD=your_email_password

CELERY_BROKER_URL=redis://localhost:6379/0
CELERY_RESULT_BACKEND=redis://localhost:6379/0
REDIS_URL=redis://localhost:6379/0
```

---

## ğŸ‰ æµ‹è¯•åŠŸèƒ½

1. è®¿é—® http://127.0.0.1:5000
2. ç™»å½•è´¦å·
3. ç‚¹å‡»ç´ æè¯¦æƒ…
4. ç‚¹å‡»"é«˜çº§AIä¸‹è½½"
5. è§‚å¯ŸçŠ¶æ€å˜åŒ–ï¼š
   - âœ… ä»»åŠ¡ç­‰å¾…ä¸­ â†’ ä»»åŠ¡æ­£åœ¨å¤„ç†ä¸­ â†’ ä»»åŠ¡å®Œæˆ

---

## ğŸ“Š é¡¹ç›®æ¶æ„

```
Flask åº”ç”¨ (ç«¯å£ 5000)
    â†“
Redis (ç«¯å£ 6379) â† ä»»åŠ¡é˜Ÿåˆ— + é™æµå­˜å‚¨
    â†“
Celery Worker â† å¤„ç†å¼‚æ­¥ä»»åŠ¡
```

---

## ğŸ”§ è¯Šæ–­å·¥å…·

è¿è¡Œè¯Šæ–­è„šæœ¬æ£€æŸ¥é…ç½®ï¼š
```bash
python diagnose_celery.py
```
